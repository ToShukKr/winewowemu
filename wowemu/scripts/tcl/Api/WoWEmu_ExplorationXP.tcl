# StartTCL: b
#
#
# This file is part of the StartTCL Startup System
#
# StartTCL is (c) 2006 by Lazarus Long <lazarus.long@bigfoot.com>
# StartTCL is (c) 2006 by Spirit <thehiddenspirit@hotmail.com>
#
# StartTCL is free software; you can redistribute it and/or modify it under
# the terms of the GNU Lesser General Public License as published by the Free
# Software Foundation; either version 2.1 of the License, or (at your option)
# any later version.
#
# StartTCL is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
# A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more
# details.
#
# You should have received a copy of the GNU Lesser General Public License
# along with this program; if not, write to the Free Software Foundation, Inc.,
# 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA. You can also consult
# the terms of the license at:
#
#		<http://www.gnu.org/copyleft/lesser.html>
#
#
# Name:		WoWEmu_ExplorationXP.tcl
#
# Description:	TCL API procedures
#
# Based on original WAD and on contributions from the community, thanks to all.
#
#


#
#	variable ::WoWEmu::AreaLevels
#
variable ::WoWEmu::AreaLevels
array set ::WoWEmu::AreaLevels {
	1	0
	2	0
	3	0
	4	0
	7	0
	8	0
	9	0
	10	0
	11	0
	12	0
	13	0
	14	0
	15	0
	16	0
	17	0
	18	7
	19	40
	20	14
	21	0
	22	0
	23	0
	24	0
	25	0
	26	0
	28	0
	30	0
	32	0
	33	0
	34	0
	35	42
	36	0
	37	36
	38	0
	40	0
	41	0
	42	25
	43	42
	44	0
	45	0
	46	0
	47	0
	49	0
	51	0
	53	0
	54	8
	55	0
	56	0
	57	5
	59	0
	60	8
	61	0
	62	8
	63	6
	64	6
	65	0
	66	0
	67	0
	68	16
	69	15
	70	24
	71	20
	72	63
	73	50
	74	43
	75	37
	76	37
	77	0
	80	10
	81	0
	82	0
	83	0
	84	0
	85	0
	86	8
	87	5
	88	6
	89	0
	91	8
	92	0
	93	28
	94	24
	95	20
	96	25
	97	19
	98	17
	99	30
	100	31
	101	32
	102	41
	103	40
	104	37
	105	42
	106	0
	107	14
	108	15
	109	15
	111	12
	113	15
	115	17
	116	39
	117	35
	118	22
	120	8
	121	28
	122	37
	123	34
	125	35
	126	0
	127	40
	128	36
	129	37
	130	0
	131	5
	132	0
	133	10
	134	10
	135	7
	136	5
	137	7
	138	7
	139	0
	141	0
	142	15
	143	18
	144	10
	145	18
	146	15
	147	15
	148	0
	149	12
	150	20
	151	0
	152	9
	153	10
	154	0
	155	0
	156	6
	157	8
	158	0
	159	5
	160	12
	161	10
	162	7
	163	0
	164	7
	165	5
	166	5
	167	8
	168	0
	169	0
	170	0
	172	18
	173	0
	186	5
	187	7
	188	0
	189	5
	190	56
	192	55
	193	55
	195	0
	196	0
	197	50
	198	55
	199	50
	200	54
	201	57
	202	46
	203	0
	204	15
	205	28
	206	0
	207	0
	208	0
	209	16
	210	0
	211	7
	212	8
	213	13
	214	0
	215	0
	219	15
	220	0
	221	0
	222	5
	223	0
	224	7
	225	9
	226	11
	227	11
	228	10
	229	12
	230	18
	231	20
	232	0
	233	15
	235	0
	236	16
	237	16
	238	0
	239	11
	240	12
	241	26
	242	28
	243	0
	244	0
	245	25
	246	48
	247	45
	249	50
	250	54
	251	0
	252	57
	253	56
	254	55
	255	59
	256	0
	257	0
	258	0
	259	5
	260	6
	261	8
	262	0
	263	0
	264	9
	265	11
	266	9
	267	0
	268	0
	269	18
	271	22
	272	20
	275	21
	276	0
	277	0
	278	32
	279	30
	280	34
	281	36
	282	35
	283	35
	284	27
	285	21
	286	22
	287	0
	288	27
	289	26
	290	30
	293	30
	294	30
	295	30
	296	0
	297	50
	298	0
	299	0
	300	41
	301	0
	302	0
	303	0
	305	0
	306	0
	307	48
	308	0
	309	24
	310	41
	311	44
	312	0
	313	31
	314	33
	315	31
	316	35
	317	33
	318	36
	320	30
	321	30
	322	0
	323	0
	324	36
	325	0
	326	0
	327	40
	328	0
	330	0
	331	0
	332	0
	333	38
	334	38
	335	38
	336	38
	337	36
	338	39
	339	45
	340	38
	341	36
	342	39
	343	0
	344	43
	345	39
	346	36
	347	43
	348	41
	349	0
	350	45
	351	48
	352	0
	353	44
	354	45
	355	46
	356	41
	357	0
	358	0
	359	25
	360	7
	361	0
	362	5
	363	0
	364	0
	365	0
	366	7
	367	6
	368	7
	369	9
	370	8
	371	0
	372	6
	373	0
	374	0
	375	0
	377	9
	378	10
	379	10
	380	15
	381	17
	382	15
	383	14
	384	11
	385	15
	386	12
	387	12
	388	15
	390	20
	391	12
	392	15
	393	0
	394	0
	395	0
	396	6
	397	7
	398	8
	399	6
	400	0
	401	0
	403	0
	404	8
	405	0
	406	0
	407	10
	408	0
	409	0
	410	8
	411	0
	412	0
	413	19
	414	20
	415	20
	416	23
	417	25
	418	23
	419	28
	420	25
	421	25
	422	26
	424	22
	425	0
	426	24
	427	0
	428	25
	429	0
	430	28
	431	25
	432	30
	433	0
	434	29
	435	0
	436	0
	437	22
	438	20
	439	35
	440	0
	441	20
	442	12
	443	19
	444	16
	445	14
	446	11
	447	11
	448	15
	449	16
	450	19
	452	0
	453	0
	454	0
	455	0
	456	14
	457	0
	458	0
	459	10
	460	20
	461	20
	463	0
	464	21
	465	25
	466	0
	467	25
	468	0
	469	0
	470	10
	471	0
	472	0
	473	0
	474	0
	475	0
	476	0
	477	43
	478	8
	479	0
	480	30
	481	24
	482	29
	483	30
	484	26
	485	25
	486	0
	487	0
	488	0
	489	0
	490	0
	491	0
	492	26
	493	0
	495	0
	496	36
	497	0
	498	0
	499	0
	500	0
	501	0
	502	36
	503	0
	504	0
	505	0
	506	0
	507	36
	508	0
	509	38
	510	0
	511	43
	512	0
	513	36
	514	0
	515	0
	516	0
	517	0
	518	36
	536	24
	537	55
	538	49
	539	53
	540	51
	541	0
	542	0
	543	53
	556	12
	576	25
	596	35
	597	0
	598	0
	599	30
	600	0
	602	39
	603	31
	604	36
	606	34
	607	37
	608	30
	609	32
	616	0
	618	0
	636	0
	637	0
	638	0
	639	0
	640	0
	656	15
	657	37
	676	0
	696	0
	697	0
	698	0
	699	0
	700	0
	701	0
	702	11
	716	0
	717	0
	718	0
	719	0
	720	0
	721	0
	722	0
	736	8
	796	0
	797	8
	798	8
	799	10
	800	4
	801	8
	802	8
	803	7
	804	8
	805	0
	806	12
	807	0
	808	11
	809	7
	810	7
	811	5
	812	10
	813	52
	814	0
	815	0
	816	8
	817	10
	818	5
	819	9
	820	5
	821	8
	836	20
	837	0
	838	0
	839	0
	856	19
	876	0
	877	0
	878	0
	879	0
	880	30
	881	0
	896	30
	916	9
	917	18
	918	14
	919	14
	920	17
	921	16
	922	18
	923	13
	924	11
	925	12
	926	0
	927	14
	928	0
	936	12
	956	0
	976	40
	977	40
	978	45
	979	44
	980	49
	981	48
	982	48
	983	47
	984	47
	985	44
	986	45
	987	48
	988	0
	989	0
	990	50
	991	0
	992	47
	996	22
	997	20
	998	25
	999	0
	1000	22
	1001	16
	1002	16
	1016	28
	1017	30
	1018	25
	1019	0
	1020	22
	1021	22
	1022	24
	1023	25
	1024	20
	1025	21
	1036	28
	1037	25
	1038	25
	1039	25
	1056	31
	1057	0
	1076	21
	1097	19
	1098	30
	1099	42
	1100	41
	1101	44
	1102	0
	1103	42
	1104	0
	1105	44
	1106	46
	1107	0
	1108	49
	1109	0
	1110	0
	1111	60
	1112	0
	1113	60
	1114	49
	1115	0
	1116	0
	1117	0
	1118	0
	1119	48
	1120	43
	1121	44
	1136	0
	1137	42
	1156	0
	1157	0
	1176	0
	1196	0
	1216	49
	1217	0
	1218	0
	1219	52
	1220	52
	1221	48
	1222	0
	1223	0
	1224	0
	1225	49
	1226	55
	1227	50
	1228	52
	1229	53
	1230	51
	1231	52
	1232	54
	1233	49
	1234	52
	1235	46
	1236	45
	1237	49
	1256	42
	1276	0
	1277	20
	1296	0
	1297	0
	1316	33
	1336	45
	1337	0
	1338	0
	1339	0
	1357	36
	1377	0
	1397	0
	1417	0
	1437	47
	1438	50
	1439	55
	1440	51
	1441	54
	1442	48
	1443	0
	1444	56
	1445	0
	1446	0
	1457	47
	1477	0
	1497	10
	1517	0
	1518	0
	1519	10
	1537	10
	1557	0
	1577	0
	1578	0
	1579	0
	1580	0
	1581	0
	1582	0
	1583	0
	1584	0
	1597	0
	1598	0
	1599	0
	1600	0
	1601	0
	1602	0
	1603	0
	1617	0
	1637	10
	1638	10
	1639	0
	1640	0
	1641	0
	1657	10
	1658	0
	1659	0
	1660	0
	1661	0
	1662	0
	1677	33
	1678	33
	1679	33
	1680	34
	1681	31
	1682	39
	1683	34
	1684	30
	1697	18
	1698	20
	1699	13
	1700	19
	1701	20
	1702	18
	1703	17
	1704	11
	1717	24
	1718	0
	1737	40
	1738	43
	1739	42
	1740	36
	1741	43
	1742	0
	1757	0
	1758	0
	1759	0
	1760	0
	1761	47
	1762	54
	1763	51
	1764	0
	1765	52
	1766	53
	1767	53
	1768	0
	1769	54
	1770	0
	1771	0
	1777	36
	1778	41
	1779	0
	1780	36
	1797	41
	1798	36
	1817	0
	1837	0
	1857	32
	1858	32
	1877	42
	1878	39
	1879	40
	1880	0
	1881	0
	1882	45
	1883	48
	1884	46
	1885	42
	1886	47
	1887	0
	1897	36
	1898	39
	1917	49
	1937	42
	1938	45
	1939	45
	1940	49
	1941	0
	1942	48
	1943	50
	1957	47
	1958	43
	1959	45
	1977	0
	1978	41
	1997	0
	1998	53
	2017	0
	2037	0
	2057	0
	2077	0
	2078	0
	2079	61
	2097	26
	2098	0
	2099	0
	2100	0
	2101	0
	2102	0
	2103	0
	2104	0
	2117	0
	2118	0
	2119	0
	2137	0
	2138	0
	2157	0
	2158	0
	2159	0
	2160	0
	2161	0
	2177	0
	2197	0
	2198	30
	2217	0
	2237	28
	2238	0
	2239	0
	2240	0
	2241	57
	2242	58
	2243	55
	2244	57
	2245	56
	2246	55
	2247	56
	2248	0
	2249	60
	2250	56
	2251	56
	2252	0
	2253	55
	2254	0
	2255	55
	2256	60
	2257	0
	2258	58
	2259	0
	2260	54
	2261	54
	2262	55
	2263	55
	2264	57
	2265	0
	2266	55
	2267	0
	2268	58
	2269	0
	2270	58
	2271	56
	2272	58
	2273	57
	2274	0
	2275	56
	2276	59
	2277	55
	2278	0
	2279	55
	2280	0
	2297	55
	2298	55
	2299	0
	2300	50
	2301	23
	2302	39
	2303	27
	2317	0
	2318	0
	2319	0
	2320	0
	2321	0
	2322	0
	2323	0
	2324	0
	2325	0
	2326	0
	2337	0
	2338	0
	2339	0
	2357	0
	2358	0
	2359	24
	2360	0
	2361	15
	2362	0
	2363	0
	2364	0
	2365	0
	2366	0
	2367	0
	2368	0
	2369	0
	2370	0
	2371	0
	2372	0
	2373	0
	2374	0
	2375	0
	2376	0
	2377	0
	2378	0
	2379	0
	2397	0
	2398	0
	2399	0
	2400	0
	2401	0
	2402	0
	2403	0
	2404	30
	2405	32
	2406	35
	2407	32
	2408	33
	2417	54
	2418	55
	2419	0
	2420	52
	2421	54
	2437	0
	2457	0
	2477	0
	2478	47
	2479	48
	2480	50
	2481	51
	2497	53
	2517	46
	2518	0
	2519	41
	2520	0
	2521	0
	2522	45
	2537	15
	2538	15
	2539	15
	2540	16
	2541	18
	2557	0
	2558	0
	2559	0
	2560	0
	2561	57
	2562	60
	2563	0
	2577	44
	2597	0
	2617	0
	2618	50
	2619	55
	2620	0
	2621	54
	2622	55
	2623	59
	2624	58
	2625	0
	2626	0
	2627	55
	2637	0
	2657	0
	2677	0
	2697	50
	2717	0
	2737	55
	2738	55
	2739	55
	2740	55
	2741	0
	2742	55
	2743	55
	2744	55
	2757	0
	2777	0
	2797	0
	2817	0
	2837	0
	2838	0
	2839	0
	2857	0
	2877	60
	2897	0
	2917	0
	2918	0
	2937	0
	2938	50
	2957	0
	2958	0
	2959	0
	2960	0
	2961	0
	2962	0
	2963	0
	2964	0
	2977	0
	2978	0
	2979	0
	3017	0
	3037	0
	3038	0
	3039	0
	3057	0
	3058	0
	3077	55
	3097	0
	3098	57
	3099	59
	3100	0
	3117	0
	3137	0
	3138	0
	3139	0
	3140	0
	3157	0
	3177	0
	3197	0
	3217	0
	3237	0
	3257	0
	3277	0
	3297	0
	3298	0
	3299	0
	3300	0
	3301	0
	3302	0
	3303	0
	3304	0
	3305	0
	3306	0
	3317	0
	3318	0
	3319	0
	3320	0
	3321	0
	3337	0
	3338	0
	3357	0
	3358	0
	3377	0
	3378	0
	3379	0
	3380	0
	3381	0
	3382	0
	3383	0
	3384	0
	3397	0
	3398	0
	3417	0
	3418	0
	3419	0
	3420	0
	3421	0
	3422	0
	3423	0
	3424	0
	3425	55
	3426	59
	3427	0
	3446	0
	3447	0
}


#
#	variable ::WoWEmu::AreaBaseXP
#
variable ::WoWEmu::AreaBaseXP
array set ::WoWEmu::AreaBaseXP {
	0	0
	1	5
	2	15
	3	25
	4	35
	5	45
	6	55
	7	65
	8	70
	9	80
	10	85
	11	90
	12	90
	13	90
	14	100
	15	105
	16	115
	17	125
	18	135
	19	145
	20	155
	21	165
	22	175
	23	185
	24	195
	25	200
	26	210
	27	220
	28	230
	29	235
	30	245
	31	250
	32	255
	33	265
	34	270
	35	275
	36	280
	37	285
	38	285
	39	300
	40	315
	41	330
	42	345
	43	360
	44	375
	45	390
	46	405
	47	420
	48	440
	49	455
	50	470
	51	490
	52	510
	53	525
	54	545
	55	560
	56	580
	57	600
	58	620
	59	640
	60	660
	61	680
	62	700
	63	720
	64	740
	65	760
	66	780
	67	800
}


#
#	proc ::WoWEmu::ExplorationXP { player location }
#
proc ::WoWEmu::ExplorationXP { player location } {
	variable AreaLevels
	variable AreaBaseXP

	if { [ set player_level [ ::GetLevel $player ] ] >= $::WoWEmu::MAX_LEVEL || [ ::GetQFlag $player IsDead ] } {
		return 0
	}

	set area_level [ expr { [ info exists AreaLevels($location) ] ? $AreaLevels($location) : 0 } ]
	set lvldiff [ expr { $player_level - $area_level } ]

	if { $lvldiff < -5 } {
		set percent [ expr { 100 + ($lvldiff + 5) * 5 } ]

		if { $percent < 0 } {
			set percent 0
		}

		set xp [ expr { round($AreaBaseXP($area_level) * $percent / 100.) } ]
	} elseif { $lvldiff > 5 } {
		set level [ expr { $area_level - 5 } ]
		set xp [ expr { [ info exists AreaBaseXP($level) ] ? $AreaBaseXP($level) : 0 } ]
	} else {
		set xp $::WoWEmu::AreaBaseXP($area_level)
	}

	return $xp
}

